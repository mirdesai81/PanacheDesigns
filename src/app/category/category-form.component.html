<app-navbar></app-navbar>
<div class="container" id="main">

      <form [formGroup]="categoryForm" class="col-md-10" novalidate *ngIf="active" (ngSubmit)="save($event)">
        <div class="md-form">
          <label for="title">Category Name</label>
          <input type="text" formControlName="title" class="form-control validate">
        </div>
        <div *ngIf="formErrors.title" class="alert alert-danger">
          {{formErrors.title}}
        </div>
        <div class="md-form">
          <label for="title">Category Description</label>
          <input type="text" formControlName="desc" class="form-control validate">
        </div>
        <div *ngIf="formErrors.desc" class="alert alert-danger">
          {{formErrors.desc}}
        </div>
        <div class="md-form">
          <label for="parent">Parent Category</label>
          <select formControlName="parent" class="form-control">
            <option *ngFor="let c of categories" [value]="c._id">{{c.title}}</option>
          </select>
        </div>
        <div class="text-md-center">
          <button type="submit" class="btn btn-primary" [disabled]="!categoryForm.valid">Save</button>
        </div>
      </form>
      <table class="table table-striped table-bordered">
        <thead>
        <th>Title</th>
        <th>Description</th>
        <th>Parent</th>
        <th>Ancestors</th>
        <th>Children</th>
        <th>Delete</th>
        </thead>
        <tr *ngFor="let category of categories">
          <td>{{category.title}}</td>
          <td>{{category.desc}}</td>
          <td>{{category.parent?.title}}</td>
          <td><ng-template ngFor let-i="index" let-c="count" let-last="last" let-ancestors [ngForOf]="category.ancestors">{{ancestors?.title}}<ng-template [ngIf]="!last">, </ng-template></ng-template></td>
          <td><ng-template ngFor let-i="index" let-c="count" let-last="last" let-children [ngForOf]="category.children">{{children?.title}}<ng-template [ngIf]="!last">, </ng-template></ng-template></td>
          <td><a (click)="deleteCategory(category)"><i class="fa fa-trash"></i></a></td>
        </tr>
      </table>

</div>
<app-footer></app-footer>

